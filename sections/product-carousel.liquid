<div class="product-carousel-section">
  {% if section.settings.title != blank %}
    <h2 class="carousel-title">{{ section.settings.title }}</h2>
  {% endif %}

  <div class="carousel-wrapper">
    <button class="carousel-btn left" onclick="scrollCarousel('{{ section.id }}', -1)">&#10094;</button>

    <div id="carousel-{{ section.id }}" class="carousel-container">
      {% for product in section.settings.products %}
        {% assign p = all_products[product] %}
        {% if p %}
          <div class="carousel-item">
            <a href="{{ p.url }}" class="carousel-img-wrapper">
              <img src="{{ p.featured_image | image_url: '400x' }}" alt="{{ p.title }}" width="400" height="400" loading="lazy">
            </a>
            <p class="carousel-item-title">{{ p.title }}</p>
            <p class="carousel-item-price">{{ p.price | money }}</p>
            <form method="post" action="{{ routes.cart_add_url }}">
              <input type="hidden" name="id" value="{{ p.variants.first.id }}">
              <button type="submit" class="carousel-add-btn">Add to Cart</button>
            </form>
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <button class="carousel-btn right" onclick="scrollCarousel('{{ section.id }}', 1)">&#10095;</button>
  </div>
</div>

<style>
.product-carousel-section {
  padding: 30px 0;
}
.carousel-title {
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 15px;
}
.carousel-wrapper {
  display: flex;
  align-items: center;
  position: relative;
}
.carousel-container {
  display: flex;
  gap: 20px;
  overflow-x: auto;
  scroll-behavior: smooth;
  padding: 10px;
}
.carousel-container::-webkit-scrollbar {
  display: none;
}
.carousel-item {
  min-width: 200px;
  text-align: center;
}
.carousel-img-wrapper img {
  width: 100%;
  border-radius: 10px;
  object-fit: cover;
}
.carousel-item-title {
  margin: 8px 0 3px;
  font-size: 16px;
  font-weight: 500;
}
.carousel-item-price {
  font-size: 15px;
  font-weight: 600;
  color: #222;
}
.carousel-add-btn {
  margin-top: 6px;
  padding: 8px 14px;
  background: #000;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
.carousel-btn {
  background: none;
  border: none;
  font-size: 30px;
  cursor: pointer;
  padding: 10px;
}
</style>

<script>
function scrollCarousel(id, direction) {
  const carousel = document.getElementById("carousel-" + id);
  const itemWidth = 220;
  carousel.scrollLeft += direction * itemWidth;
}
</script>

{% schema %}
{
  "name": "Product Carousel",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Carousel Title",
      "default": "Recommended Products"
    },
    {
      "type": "product_list",
      "id": "products",
      "label": "Select Products",
      "limit": 10
    }
  ],
  "presets": [
    {
      "name": "Product Carousel"
    }
  ]
}
{% endschema %}
